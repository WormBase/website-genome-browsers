<html>
<head>

<script>
 async function buildURL(protein, length) {
  //let protein = 'CE28239';
  //let length = 1113;
  let proto    = window.location.protocol;
  let hostname = window.location.hostname;
  let port     = window.location.port;
  let path     = '/tools/protein_schematic/';

  if (port != 80) {
      port = ':'+port;
  }
  else {
      port = '';
  }
  
  let releaseVersion = 'WS274';

  //let releaseVersionPromise = fetch(' version rest');
  
  
  let jbrowseBaseURL = proto+'//' + hostname + port + path';

  //let baseURL = 'https://staging.wormbase.org/tools/protein_schematic/';
  let baseURL = 'https://s3.amazonaws.com/wormbase-modencode/protein_schematic/'+ releaseVersion + '/';
  let urlTemplate = baseURL+'tracks/';

  let trackPart = 'Exon%20boundaries';
  
  let response = await fetch(urlTemplate+'seg/'+protein+'/trackData.jsonz');

  if (response.ok) { // if HTTP-status is 200-299
    trackPart = trackPart + '%2Cseg';
  }

  response = await fetch(urlTemplate+'signalp/'+protein+'/trackData.jsonz');

  if (response.ok) { // if HTTP-status is 200-299
    trackPart = trackPart + '%2Csignalp';
  }

  response = await fetch(urlTemplate+'tmhmm/'+protein+'/trackData.jsonz');

  if (response.ok) { // if HTTP-status is 200-299
    trackPart = trackPart + '%2Ctmhmm';
  }

  response = await fetch(urlTemplate+'ncoils/'+protein+'/trackData.jsonz');

  if (response.ok) { // if HTTP-status is 200-299
    trackPart = trackPart + '%2Cncoils';
  }

  response = await fetch(urlTemplate+'Catalytic%20residue/'+protein+'/trackData.jsonz');

  if (response.ok) { // if HTTP-status is 200-299
    trackPart = trackPart + '%2CCatalytic%20residue';
  }

  response = await fetch(urlTemplate+'Metal%20binding%20site/'+protein+'/trackData.jsonz');

  if (response.ok) { // if HTTP-status is 200-299
    trackPart = trackPart + '%2CMetal%20binding%20site';
  }

  response = await fetch(urlTemplate+'Post%20transcriptionally%20modified%20site/'+protein+'/trackData.jsonz');

  if (response.ok) { // if HTTP-status is 200-299
    trackPart = trackPart + '%2CPost%20transcriptionally%20modified%20site';
  }

  response = await fetch(urlTemplate+'Motifs/'+protein+'/trackData.jsonz');

  if (response.ok) { // if HTTP-status is 200-299
    trackPart = trackPart + '%2CMotifs';
  }

  response = await fetch(urlTemplate+'Selected%20BLASTP%20Homologies/'+protein+'/trackData.jsonz');

  if (response.ok) { // if HTTP-status is 200-299
    trackPart = trackPart + '%2CSelected%20BLASTP%20Homologies';
  }  

  let fullJBrowseURL = jbrowseBaseURL+'?tracklabels=0&nav=0&tracklist=0&overview=0&loc='+protein+'%3A1..'+length+'&tracks='+trackPart;
  //alert(fullJBrowseURL);

  document.getElementById("replaceme").innerHTML='<object id="innerJBrowse" type="text/html" style="width:100%;height:400px;overflow: auto;" data="'+fullJBrowseURL+'" ></object>';  

  return ;
 }
</script>

</head>
<body>

<div id="replaceme" style="width:100%;height:400px;background-color:#fff;resize: vertical;overflow: auto;">hello</div>

<button type="button" onclick="buildURL('JC8.10a', 1113)">UNC-26, isoform a</button>
<button type="button" onclick="buildURL('C18D11.2', 266)">MAA-1</button>
<button type="button" onclick="buildURL('F11C7.3', 424)">VAP-1</button>
<button type="button" onclick="buildURL('Y48B6A.11', 922)">JMJD-2</button>
<button type="button" onclick="buildURL('T09D3.4a', 490)">NHR-216, isoform a</button>
<button type="button" onclick="buildURL('M7.7', 370)">M7.7</button>



</body>
</html>
