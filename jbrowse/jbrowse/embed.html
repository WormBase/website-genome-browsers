<div style="overflow:hidden;width:100%;height:14px;position:relative" id="jbrowse_frame">didn't load </div>

<script type="text/javascript">
    var preembedURL = "full.html?tracks=Curated_Genes%2CClassical_alleles%2CYACs_Fosmids_Cosmids&loc=X%3A12392257..12418393&data=data%2Fc_elegans_simple";
    var embed_part = "&nav=0&tracklist=0&overview=0";
    $("#jbrowse_frame").html('<object id="innerJBrowse" type="text/html" style="pointer-events:none;position:absolute;top:0;left:0;width:100%;height:14px;overflow: hidden;" data="'+preembedURL+embed_part+'"></object>');

  $(document).ready(function() {
    setTimeout( function() {
        console.log('starting the resize');

        //can't figure out how to do with with jquery
        var window = document.getElementById('innerJBrowse').contentDocument || document.getElementById('innerJBrowse').contentWindow.document;

        var tracks = window.getElementsByClassName('track');
        var h = 20;

        for (var i=0; i < tracks.length; i++) {
            var id = tracks[i].id;
            if(id == 'gridtrack' || id == 'overviewtrack_overview_loc_track' || id == 'static_track') {
                continue;
            }
            h += tracks[i].offsetHeight;
        }

        console.log(h);
        $('#jbrowse_frame').height(h);
        $('#innerJBrowse') .height(h);

        //This doesn't seem necessary when using jquery
        //$('#innerJBrowse').load(jbrowseURL);

        //create the big invisible button with jquery
        var invisDiv = $('<div id="jbrowse_link" style="cursor:pointer;position:absolute;top:0;left:0;width:100%;height:'+h+';pointer-events:auto" ></div>').text(" ");
        $('#jbrowse_frame').append(invisDiv);
        invisDiv.click(function() {
            preembedURL = preembedURL.replace('_simple', '_PRJNA13758');
            location.assign(preembedURL);
        });

     } , 12000);
  });
</script>

